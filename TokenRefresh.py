#A big thank you to @mohammadaskar2 for helping speak parseltongue!
#Also a big shout out to Parsia (@CryptoGangsta) for their Swing in Python Burp Extensions blog
#(https://parsiya.net/blog/2019-11-04-swing-in-python-burp-extensions-part-1/)
import os
import threading
from java.lang import Short
from javax.swing import (JScrollPane, JPanel, JTextField, JLabel, JToggleButton, JCheckBox, GroupLayout, JFrame, JTextArea, JButton, JInternalFrame,ImageIcon, LayoutStyle)
from burp import IBurpExtender
from burp import IHttpListener
from burp import ISessionHandlingAction
from burp import ITab
import re
import urlparse
import base64


class BurpExtender(IBurpExtender, IHttpListener, ISessionHandlingAction, ITab):



    def getTabCaption(self):
        return "Bearer Token Refresh"

    def getUiComponent(self):
        #from NBPanel import NBPanel
        return self.panel

    # Variables to hold the tokens found so that it can be inserted in the next request
    discoveredBearerToken = ''


    def registerExtenderCallbacks(self, callbacks):
        cb(callbacks)
        # Keep a reference to our callbacks object
        self.callbacks = callbacks
        #Define items
        self.BaseVariables = JPanel()
        self.AccessToken = JLabel()
        self.ErrorRegex = JLabel()
        self.AccessTokenValue = JTextField()
        self.BearerTokenValue = JTextField()
        self.CurrentBearerTokenPane = JScrollPane()
        self.CurrentBearerTokenValue = JTextArea()
        self.BearerTokenPaneName = JLabel()
        self.AuthEndPoint = JLabel()
        self.AuthEndPointValue = JTextField()
        self.VariablesToSend = JPanel()
        self.ContentType = JLabel()
        self.UserAgent = JLabel()
        self.UserAgentValue = JTextField()
        self.ContentTypeValue = JTextField()
        self.AuthData = JLabel()
        self.IsB64 = JCheckBox()
        self.jScrollPane1 = JScrollPane()
        self.jTextArea1 = JTextArea()
        self.jScrollPane2 = JScrollPane()
        self.AuthDataValue = JTextArea()
        self.LogPanel = JPanel()
        self.LoggingWindowArea = JScrollPane()
        self.LoggingWindowPane = JTextArea()
        self.HeaderNameValue = JTextField()
        self.AuthorisationHeader = JLabel()
        self.ReplacementValue = JTextField()
        self.jLabel1 = JLabel()
        self.jScrollPane4 = JScrollPane()
        self.jTextArea2 = JTextArea()
        self.performingrefresh = False

# Image
        LogoExists = os.path.isfile("Logo.jpg")
        if LogoExists == False:
            FileContents = b'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//////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAgAAAAAABAAAAABAAACQAAAAkAAAAAAOEJJTQQeAAAAAAAEAAAAADhCSU0EGgAAAAADSwAAAAYAAAAAAAAAAAAAALwAAABOAAAACwBhAHYAYQB0AGEAcgAuAGoAcABlAGcAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAE4AAAC8AAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAC8AAAAAFJnaHRsb25nAAAATgAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAAAABUb3AgbG9uZwAAAAAAAAAATGVmdGxvbmcAAAAAAAAAAEJ0b21sb25nAAAAvAAAAABSZ2h0bG9uZwAAAE4AAAADdXJsVEVYVAAAAAEAAAAAAABudWxsVEVYVAAAAAEAAAAAAABNc2dlVEVYVAAAAAEAAAAAAAZhbHRUYWdURVhUAAAAAQAAAAAADmNlbGxUZXh0SXNIVE1MYm9vbAEAAAAIY2VsbFRleHRURVhUAAAAAQAAAAAACWhvcnpBbGlnbmVudW0AAAAPRVNsaWNlSG9yekFsaWduAAAAB2RlZmF1bHQAAAAJdmVydEFsaWduZW51bQAAAA9FU2xpY2VWZXJ0QWxpZ24AAAAHZGVmYXVsdAAAAAtiZ0NvbG9yVHlwZWVudW0AAAARRVNsaWNlQkdDb2xvclR5cGUAAAAATm9uZQAAAAl0b3BPdXRzZXRsb25nAAAAAAAAAApsZWZ0T3V0c2V0bG9uZwAAAAAAAAAMYm90dG9tT3V0c2V0bG9uZwAAAAAAAAALcmlnaHRPdXRzZXRsb25nAAAAAAA4QklNBCgAAAAAAAwAAAACP/AAAAAAAAA4QklNBBEAAAAAAAEBADhCSU0EFAAAAAAABAAAAAE4QklNBAwAAAAAGYgAAAABAAAAQgAAAKAAAADIAAB9AAAAGWwAGAAB/9j/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1JHQgAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWFlaAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJDAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5QDrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQesB78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReuF9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0zRjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmkXeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1hXXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLjk02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutCW0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2OjZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////7QAMQWRvYmVfQ00AAv/uAA5BZG9iZQBkgAAAAAH/2wCEAAwICAgJCAwJCQwRCwoLERUPDAwPFRgTExUTExgRDAwMDAwMEQwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwBDQsLDQ4NEA4OEBQODg4UFA4ODg4UEQwMDAwMEREMDAwMDAwRDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDP/AABEIAKAAQgMBIgACEQEDEQH/3QAEAAX/xAE/AAABBQEBAQEBAQAAAAAAAAADAAECBAUGBwgJCgsBAAEFAQEBAQEBAAAAAAAAAAEAAgMEBQYHCAkKCxAAAQQBAwIEAgUHBggFAwwzAQACEQMEIRIxBUFRYRMicYEyBhSRobFCIyQVUsFiMzRygtFDByWSU/Dh8WNzNRaisoMmRJNUZEXCo3Q2F9JV4mXys4TD03Xj80YnlKSFtJXE1OT0pbXF1eX1VmZ2hpamtsbW5vY3R1dnd4eXp7fH1+f3EQACAgECBAQDBAUGBwcGBTUBAAIRAyExEgRBUWFxIhMFMoGRFKGxQiPBUtHwMyRi4XKCkkNTFWNzNPElBhaisoMHJjXC0kSTVKMXZEVVNnRl4vKzhMPTdePzRpSkhbSVxNTk9KW1xdXl9VZmdoaWprbG1ub2JzdHV2d3h5ent8f/2gAMAwEAAhEDEQA/AKH1XozGdcuyravRZcxmLjCQQ2hkOtd7fo+yv/PernX+uMv6F1XLaXutyb29NwJ/edrf/V9PGb/n2oXROoT0HI61kDbbTUWuIaB7iPpN/rrm+sZVtNeFjRA6djHLt/8ADOZD2lzf9JW11H/bSQLBEXMk9HMvDLbn7CfTx2tx6Ijhghzv7du5/wDbXU/WVrPq39Ren9Cr9uZ1d32vNI0cWNg1sefzm7tn+Ysf6odIf1TrWDgNHsc8PuMTDW+93+ch/X/rLesfWfLtqM42MfsuOO2yr2bm/wBd+56TIDZcbpmFb1DqONhUt3PyLWVtH9YwvUOs/wCMHp/Qms6b0StltuM00jLeD6LS32u9Cpn0n7vz1590LIs6fXl9Wrht1VX2bFedNt2SHV+qz+VXityXKhRUci7QexvA7AD81Je72b9det9SefWvuy92vpvcWVD4Y9Jaz/OVZ/WPrI9ha3Jdis5DaT6f/TZ+k/6SaqoNOgHwGiNZWXdjqErVTn/tHrn/AJY387v56z6Xj9JJS2s/GEkk0//Qy+o/aXUY/QXtdjU2Wm/qGY5hNbamFra9rme11X/COXH52e7LtsfJP2m51zgeYHsx63f8WxdR1PDzehdEy8vKzKupsynfYcB1b3OFfqNNt2Q7cKbv5genVV/M+rZ6i43FrfdfXWwS4kNaBrJKTHEUCXufqzaOh/VTrH1k/wAPY37Dgn+XZ7XPZ/xe7euAnx1Xa/4wLmdOwuk/VanQYNQyMsDg329j/wAWz/q1zf1d6W/q3WsTBY3cLbB6g59jfdZP9kJLobW3urUV4P1e6fhFwbk2H7ZfWZDj6wLaHe4f4Oln/TVXBaGUNGku1PzXef4zfqq7LpZ1nCMvw6hTk4//AALP5uynb7G+lP8ANri8LFecD1mA76hNtYBLg08XAD8z/SJDZcErIDgTwrJ9zQSeJEqpW47gSZCs72Bu0n4IJaOx3h+fHySRdP8AppIqf//R4v6ztyJbS1r30YZi678z1bPzGfyWRtVv/Fx05mT177ZeB9m6bW7KuLuPb/Nj/PVT61Z3qX+gww0GSBoNO8LVptPQPqA549mZ1+yWngiiv2N/su+kgGLXgA6nR5jrvUH9S6vlZzySbrHOE+E6LsP8WPTrGuyerARZpRikgHX6V7huLfzfYuB1PmV690jp46X0jEw3CHVVNfkN11tePVc10A/zW5NmaHmyxGweorcLRvc0NOrbGOJkSNfo+yxv9ZcP9Yfq51voWTZ1b6ttddhAl2TiNAc+n981j6duHY0/R/wX+EYuu6Zkse5wrhkaWbxIef8Ag3LWybTW2axteNRt10jiEonRJfIa836l9XY65+Rb9Xswjc+o1uyMRzhz6IpHr0bv3PoLJ6l6dLy3G6hiZVXLbWeqCQf3qra27F3+b0X6uZXVBf1DBrtpMtySwOrMvP6O11tDq/0rHfvfTWpT/iy+pFu2wYVjRJOwX2FpA7bi7dtcnA2h8Z9ez/uR+d4H/XYkvdv+Yn1Q/wDKjG42cu4/e+l9L+X/ADiSKrf/0vP8HBu6512rCYf56za55/NrBmx/+YtL6+9TpyurtxMbTFwK20UsHADRs/ztFL6pX1dKw+odbtPvYz0KB3Ln/SIXNXWuutfa8y55LnHzOqTGPVk8Iaf4Tc6DTXb1XH9XSqpwusJ421/pP+lC9Tp6kb/Re7bBkvcTBaw+5zv6+3+b/wAxeRU3PpY4Vna+zTcOdvgtXD+s/UMZjGODLK2QASIcAP3XMhNkLZH1Zr2PoL/aTy4RDT+97Vbtcz7LtrcxhI/RuLgwEx+88/Q/srg+mdYN1NJocSdXMpAJdO4zV7j9F73b2fTV1nUcyqp9Tn+sHy5jiZIJ9m6t/wDNWs3t310/6RNFhTt43UWYtm58WUMMWzqCT+e5o/0n5lf+jXS9Iycc1h1YNdNklkxtZ/V/rfmrz8XnVhJDXEF25oNj3fmubWwbv5D/ANJ/o1t9F6oyjLGMGucJP0yC4u52vaPbS392v/wROgUSe19Q/jPB+7j/AMDSQP2hV/pB49uf9D/xv/CJJ6z6v//T87c4fsxrXNe1pd7dQGE/vsb9L/jVY6z9XW9Krqtb1PBz2Wx7cS4WWNJG79LTG5iJ03Dfk4zasmh7sYvLmuaWtLSefScWOs9Pb/g9/p71HrnRcHBtx6sG6y+7I3OdQ8NljR/N/pWO9zrP+LSQKunHDdfZJ8EZuO5wa2DLwSO5MfSiFPHosZeWPYWPEhwcCC088fvK9SxsXNIAAH6EfSG9v5jnN/erc9JKLGyL8B5bW+KnjVwPadv0mfmv/MctXA62BZNx1Nroa76Iaf3Gt9u2v8xUX4jboYwEt9znT+dBFdLQ79xrne3+QquWxrQ1lI3MbWYf+c4jR1jf5CVWp7ptmPYd9FjXCzdAY7cWPaG7vW/d3bkX7K+ivfVLWEbtxbDombefo8+/YvPas19OR61DyTayLRxBIh7dfpcblou6xnfY6r6Ml4dV7Nu4+4D8x9Z+k3Z+8hQQbe3+0ZXifo+J+j+/x/0kl57/AM4upf6Q/wA16Pf6KSKKPZ//1POKczqWC2u2nIewcsaDIEdtjpYrWVXd1TByeuWvaLar6seyljNrYtZY6q1pnb9Kh+6vapu6bkVYp+20uxqXkQ+wbXg/yK3e5QFO3Ewun6VvyC7Mt3jgEbMRr/3Wem31P/QhIq8V8Oq1035D32WO+jqd7iAW++x30fTY36f5itYWJsdSTDiBPEaOBH6X6X061dxcex1bXtbsdaPZJEtI/wAGB/pfpo78TYdohwrEkakn82llm3938/8Ac/wibxKc60tqxhLtomHQZI3GKGa/4TY3f/X96xciyy1rrQID4bB5DR7e3+k/OWtn1WXvZVqG7C5vjAH6e138pzvzlWsxN1sNlraYLok/TA9MN/4XYnKcuxtjXBr/AKTRx4eSgSRxp/sV/Ixm1sdY4hrrHkViZaGgT7n/ALyoOMwkpZJJJJT/AP/V4HBx33XM+1ktx9w9e2x2pYDuLGb/AM9ytDNsv+sF+Vl1AOucXNqA9vpRtZS3/g/Qbsqd+Ys6hxqhmQHMc73Mc8e0j+SStPKoNgoyCTDDq79xrtPU/wCKZZ/Obv8ASJpOqaehwMJtNZAM1sFUghxitx32t49TY/1trm/vv9JTyK2hjWOJaAeHfmMYTrZ+b79v6VFqf6FIYdxIgOOklu+bHOH6T1LNjfT/AJdNdHprP6v1BmJjkOO4kb4eRq4x6H0D+kfp6n7lbEKCGg6gWvvtcPTA/R+O2tn6Wx/9f/BbP37ULOtqx2b7SA/U7B2BEbGN/koV/wBYMamn0aAbnACH/RG462OdI925/wDYWHk5VuTYbLDJOoHbVOAUq/KtvI3mGj6LBwPP+sg6pJIqUkkkkp//1vMxm2nG+yWnfQDuY0wXMP8Awbz7mNd+4tCjJsqoa/Ft9fHLtcZ5AuaWiZ/4Rn9VZQFbh7jteT9LsoSWnQ8cEJUp18v6x9QuBZWWVVuA+g33aCJn99Zlt1tzzZa8vefznao1F9EtrvEM3glzBqBG3d/K/qrQtxMWqzGG4W+rW837BDQ38x7J/PTduig4pMpJzGsawmTlKSSSSUpJJJJT/9fyuVJpaCJEjuFFJJTewsTGeTfY92yobvTY0lzo/l/QY399yjl577nk/RDtIboI/db/ACVVD3AEBxAPICYmUKUskkkipSSSSSlJJJJKf//Q8rSSSSUpJJJJSkkkklKSSSSUpJJJJT//2ThCSU0EIQAAAAAAVQAAAAEBAAAADwBBAGQAbwBiAGUAIABQAGgAbwB0AG8AcwBoAG8AcAAAABMAQQBkAG8AYgBlACAAUABoAG8AdABvAHMAaABvAHAAIABDAFMANgAAAAEAOEJJTQQGAAAAAAAHAAYAAAABAQD/4Q19aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSIxMkMxRDlEM0FBNjY0MkZGRjNBMzlFNzA4MkJDNURBNCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDQ0E0MzFGNzUyMjVFRDExQjFCMEUyMjQ2MDU5Q0ZCOCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSIxMkMxRDlEM0FBNjY0MkZGRjNBMzlFNzA4MkJDNURBNCIgZGM6Zm9ybWF0PSJpbWFnZS9qcGVnIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMS0wNy0xOVQxMDo1MjoxMiswMTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjItMDgtMjZUMTY6MjI6NTgrMDE6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjItMDgtMjZUMTY6MjI6NTgrMDE6MDAiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpDQkE0MzFGNzUyMjVFRDExQjFCMEUyMjQ2MDU5Q0ZCOCIgc3RFdnQ6d2hlbj0iMjAyMi0wOC0yNlQxNjoyMjo1OCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOkNDQTQzMUY3NTIyNUVEMTFCMUIwRTIyNDYwNTlDRkI4IiBzdEV2dDp3aGVuPSIyMDIyLTA4LTI2VDE2OjIyOjU4KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD94cGFja2V0IGVuZD0idyI/Pv/uAA5BZG9iZQBkQAAAAAH/2wCEAAICAgICAgICAgIDAgICAwQDAgIDBAUEBAQEBAUGBQUFBQUFBgYHBwgHBwYJCQoKCQkMDAwMDAwMDAwMDAwMDAwBAwMDBQQFCQYGCQ0KCQoNDw4ODg4PDwwMDAwMDw8MDAwMDAwPDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDP/AABEIALwATgMBEQACEQEDEQH/3QAEAAr/xAGiAAAABwEBAQEBAAAAAAAAAAAEBQMCBgEABwgJCgsBAAICAwEBAQEBAAAAAAAAAAEAAgMEBQYHCAkKCxAAAgEDAwIEAgYHAwQCBgJzAQIDEQQABSESMUFRBhNhInGBFDKRoQcVsUIjwVLR4TMWYvAkcoLxJUM0U5KismNzwjVEJ5OjszYXVGR0w9LiCCaDCQoYGYSURUaktFbTVSga8uPzxNTk9GV1hZWltcXV5fVmdoaWprbG1ub2N0dXZ3eHl6e3x9fn9zhIWGh4iJiouMjY6PgpOUlZaXmJmam5ydnp+So6SlpqeoqaqrrK2ur6EQACAgECAwUFBAUGBAgDA20BAAIRAwQhEjFBBVETYSIGcYGRMqGx8BTB0eEjQhVSYnLxMyQ0Q4IWklMlomOywgdz0jXiRIMXVJMICQoYGSY2RRonZHRVN/Kjs8MoKdPj84SUpLTE1OT0ZXWFlaW1xdXl9UZWZnaGlqa2xtbm9kdX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'
            f = os.open("Logo.jpg", os.O_WRONLY|os.O_CREAT)
            FileContents = base64.b64decode(FileContents)
            os.write(f, FileContents)
            os.close(f)
        LogoFile = os.getcwd() + "\Logo.jpg"
        self.Wowzers = JInternalFrame()
        self.Wowzers.setFrameIcon(ImageIcon(LogoFile))
        WowzersLayout = GroupLayout(self.Wowzers.getContentPane())
        self.Wowzers.getContentPane().setLayout(WowzersLayout)
        WowzersLayout.setHorizontalGroup(
            WowzersLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGap(0, 66, Short.MAX_VALUE)
        )
        WowzersLayout.setVerticalGroup(
            WowzersLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        )
        self.Wowzers.setVisible(True)

#Action buttons
        def TokenRefresh(event):
            if self.IsEnabled.isSelected():
                self.BearerRefresh()
            else:
                self.LoggingWindowPane.append('Cannot refresh token as extension currently disabled\n')

        self.TokenRefreshButton = JButton('Refresh Token', actionPerformed = TokenRefresh)

        def ClearLogWindow(event):
            self.LoggingWindowPane.setText('')

        self.ClearLogs = JButton('Clear Logs', actionPerformed = ClearLogWindow)

        def ContentTypeSwitch(event):

            if self.ContentTypeValue.isEnabled():
                self.ContentTypeValue.setEnabled(False)
            else:
                self.ContentTypeValue.setEnabled(True)

        self.ContentTypeEnabled = JCheckBox('Enabled', actionPerformed = ContentTypeSwitch)
        self.ContentTypeValue.setEnabled(False)

        def ScopeChange(event):
            if self.InScopeOnly.isSelected():
                self.InScopeOnly.setText("In Scope Only : ON")
            else:
                self.InScopeOnly.setText("In Scope Only : OFF")

        self.InScopeOnly = JToggleButton('In Scope Only : OFF', actionPerformed = ScopeChange)

        def DebugChange(event):
            if self.DebugEnabled.isSelected():
                self.DebugEnabled.setText("Disable Debugging")
            else:
                self.DebugEnabled.setText("Enable Debugging")

        self.DebugEnabled = JToggleButton('Enable Debugging', actionPerformed = DebugChange)

        def ToggleOnOff(event):
            if self.IsEnabled.isSelected():
                self.IsEnabled.setText("Stop Token Refresher")
            else:
                self.IsEnabled.setText("Start Token Refresher")

        self.IsEnabled = JToggleButton('Start Token Refresher', actionPerformed = ToggleOnOff)


        #Set text in items
        self.AccessToken.setText("Access Token Regex")
        self.ErrorRegex.setText("Bearer Token Error")
        self.AccessTokenValue.setText("access_token\\\"\\:\\\"(.*?)\\\"")
        #self.AccessTokenValue.setText("token\\\"\\:\\\"(.*?)\\\"")
        self.BearerTokenValue.setText("Unauthorized")
        self.CurrentBearerTokenValue.setColumns(20)
        self.CurrentBearerTokenValue.setRows(5)
        self.CurrentBearerTokenPane.setViewportView(self.CurrentBearerTokenValue)
        self.CurrentBearerTokenValue.setEditable(False)
        self.BearerTokenPaneName.setText("Current Bearer Token Value")
        self.AuthEndPoint.setText("Authorisation Endpoint")
        self.AuthEndPointValue.setText("https://host.com/oauth/login")
        #self.AuthEndPointValue.setText("http://127.0.0.1/api/v2/login")
        self.ContentType.setText("Content Type")
        self.UserAgent.setText("User Agent")
        self.UserAgentValue.setText("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36")
        self.ContentTypeValue.setText("application/json")
        self.AuthData.setText("Auth Data")
        self.IsB64.setText("is B64")
        self.CurrentBearerTokenValue.setText("No token currently")
        self.CurrentBearerTokenValue.setLineWrap(True)
        self.HeaderNameValue.setText("Authorization:")
        self.AuthorisationHeader.setText("Authorisation Header")
        self.ReplacementValue.setText("Authorization: Bearer [TOKEN]")
        self.jLabel1.setText("Replacement Header")
        self.jScrollPane4.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_NEVER)
        self.jTextArea2.setEditable(False)
        self.jTextArea2.setColumns(20)
        self.jTextArea2.setRows(5)
        self.jTextArea2.setText("\n    Please ensure that you have a [TOKEN] variable in your replacement header to allow the extension to be able to correctly substitute it i.e. X-AUTH-USER: [TOKEN] or ACCESS-TOKEN: \"[TOKEN]\"")
        self.jScrollPane4.setViewportView(self.jTextArea2)

        #Set positions
        BaseVariablesLayout =  GroupLayout(self.BaseVariables)
        self.BaseVariables.setLayout(BaseVariablesLayout)
        BaseVariablesLayout.setHorizontalGroup(
            BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(GroupLayout.Alignment.TRAILING, BaseVariablesLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.TRAILING)
                    .addComponent(self.jScrollPane4)
                    .addGroup(BaseVariablesLayout.createSequentialGroup()
                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                            .addGroup(BaseVariablesLayout.createSequentialGroup()
                                .addComponent(self.AccessToken)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(self.AccessTokenValue, GroupLayout.PREFERRED_SIZE, 237, GroupLayout.PREFERRED_SIZE))
                            .addGroup(GroupLayout.Alignment.TRAILING, BaseVariablesLayout.createSequentialGroup()
                                .addComponent(self.ErrorRegex)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(self.BearerTokenValue, GroupLayout.PREFERRED_SIZE, 237, GroupLayout.PREFERRED_SIZE))
                            .addGroup(GroupLayout.Alignment.TRAILING, BaseVariablesLayout.createSequentialGroup()
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                    .addGroup(BaseVariablesLayout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(self.AuthEndPoint))
                                    .addGroup(BaseVariablesLayout.createSequentialGroup()
                                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                            .addComponent(self.AuthorisationHeader)
                                            .addComponent(self.jLabel1))
                                        .addGap(0, 0, Short.MAX_VALUE)))
                                .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                                    .addComponent(self.ReplacementValue)
                                    .addComponent(self.AuthEndPointValue, GroupLayout.DEFAULT_SIZE, 237, Short.MAX_VALUE)
                                    .addComponent(self.HeaderNameValue))))
                        .addGap(18, 18, 18)
                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                            .addComponent(self.CurrentBearerTokenPane, GroupLayout.PREFERRED_SIZE, 457, GroupLayout.PREFERRED_SIZE)
                            .addComponent(self.BearerTokenPaneName))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                            .addComponent(self.TokenRefreshButton, GroupLayout.DEFAULT_SIZE, 174, Short.MAX_VALUE)
                            .addComponent(self.IsEnabled, GroupLayout.DEFAULT_SIZE, 174, Short.MAX_VALUE)
                            .addComponent(self.InScopeOnly, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(self.Wowzers, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        )
        BaseVariablesLayout.setVerticalGroup(
            BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(BaseVariablesLayout.createSequentialGroup()
                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.TRAILING, False)
                    .addGroup(BaseVariablesLayout.createSequentialGroup()
                        .addGap(12, 12, 12)
                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(self.AccessToken)
                            .addComponent(self.AccessTokenValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                            .addComponent(self.BearerTokenPaneName, GroupLayout.PREFERRED_SIZE, 22, GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                            .addGroup(BaseVariablesLayout.createSequentialGroup()
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                                    .addComponent(self.BearerTokenValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                    .addComponent(self.ErrorRegex))
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                                    .addComponent(self.AuthEndPointValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                    .addComponent(self.AuthEndPoint))
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                                    .addComponent(self.HeaderNameValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                    .addComponent(self.AuthorisationHeader))
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                                    .addComponent(self.ReplacementValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                    .addComponent(self.jLabel1)))
                            .addComponent(self.CurrentBearerTokenPane)))
                    .addGroup(BaseVariablesLayout.createSequentialGroup()
                        .addGap(17, 17, 17)
                        .addComponent(self.IsEnabled, GroupLayout.PREFERRED_SIZE, 62, GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(self.InScopeOnly, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(self.TokenRefreshButton)))
                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(self.jScrollPane4, GroupLayout.DEFAULT_SIZE, 53, Short.MAX_VALUE))
            .addGroup(BaseVariablesLayout.createSequentialGroup()
                      .addGap(17, 17, 17)
                      .addGroup(BaseVariablesLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                .addComponent(self.Wowzers)
                                .addGroup(BaseVariablesLayout.createSequentialGroup()
                                          .addComponent(self.IsEnabled, GroupLayout.PREFERRED_SIZE, 62,
                                                        GroupLayout.PREFERRED_SIZE)
                                          .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                          .addComponent(self.InScopeOnly, GroupLayout.DEFAULT_SIZE,
                                                        GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                          .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                          .addComponent(self.TokenRefreshButton)
                                          .addContainerGap())))
        )
        #Define text areas

        self.jTextArea1.setColumns(20)
        self.jTextArea1.setRows(5)
        self.jTextArea1.setEditable(False)
        self.jTextArea1.setText(
            "\nToken Refresher 2.0 by @bb_hacks\n\nBased on https://github.com/t3hbb/OAuthRenew\n\nFor more details please visit \nhttps://github.com/Cybaverse/TokenRefresh\n\n")
        self.jScrollPane1.setViewportView(self.jTextArea1)

        self.AuthDataValue.setColumns(20)
        self.AuthDataValue.setRows(5)
        self.AuthDataValue.setText("grant_type=client_credentials&client_id=CLIENTID&client_secret=CLIENTSECRET&scope=SCOPE&audience=AUDIENCE")
        self.jScrollPane2.setViewportView(self.AuthDataValue)

        VariablesToSendLayout =  GroupLayout(self.VariablesToSend)
        self.VariablesToSend.setLayout(VariablesToSendLayout)
        VariablesToSendLayout.setHorizontalGroup(
            VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(VariablesToSendLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                    .addComponent(self.ContentType)
                    .addComponent(self.AuthData)
                    .addComponent(self.IsB64)
                    .addComponent(self.UserAgent))
                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                    .addComponent(self.UserAgentValue, GroupLayout.DEFAULT_SIZE, 648, Short.MAX_VALUE)
                    .addGroup(VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                        .addComponent(self.ContentTypeValue)
                        .addComponent(self.jScrollPane2, GroupLayout.DEFAULT_SIZE, 648, Short.MAX_VALUE)))
                .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(self.ContentTypeEnabled)
                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(self.jScrollPane1, GroupLayout.PREFERRED_SIZE, 306, GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        )

        VariablesToSendLayout.setVerticalGroup(
            VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(VariablesToSendLayout.createSequentialGroup()
                      .addContainerGap()
                      .addGroup(VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                .addGroup(VariablesToSendLayout.createSequentialGroup()
                                          .addGroup(
                VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                .addComponent(self.UserAgent)
                .addComponent(self.UserAgentValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE,
                              GroupLayout.PREFERRED_SIZE))
                                          .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                          .addGroup(
                VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                .addComponent(self.ContentTypeValue, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE,
                              GroupLayout.PREFERRED_SIZE)
                .addComponent(self.ContentType)
                .addComponent(self.ContentTypeEnabled))
                                          .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                          .addGroup(VariablesToSendLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                                    .addGroup(VariablesToSendLayout.createSequentialGroup()
                                                              .addComponent(self.AuthData)
                                                              .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED,
                                                                               GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                              .addComponent(self.IsB64))
                                                    .addComponent(self.jScrollPane2, GroupLayout.DEFAULT_SIZE, 112,
                                                                  Short.MAX_VALUE)))
                                .addComponent(self.jScrollPane1))
                      .addContainerGap())
        )

        self.DebugEnabled.setText("Enable Debugging")

        self.LoggingWindowPane.setColumns(20)
        self.LoggingWindowPane.setRows(5)
        self.LoggingWindowArea.setViewportView(self.LoggingWindowPane)
        self.LoggingWindowPane.append("Loading Bearer Token Refresh Tool by @bb_hacks\nBased on https://github.com/t3hbb/OAuthRenew\nCheck for an expired bearer token and replace if required.\n\nRemember to update any necessary details in the options above!\n")

        LogPanelLayout =  GroupLayout(self.LogPanel)
        self.LogPanel.setLayout(LogPanelLayout)
        LogPanelLayout.setHorizontalGroup(
            LogPanelLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(LogPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(LogPanelLayout.createParallelGroup(GroupLayout.Alignment.LEADING, False)
                    .addComponent(self.DebugEnabled, GroupLayout.DEFAULT_SIZE, 133, Short.MAX_VALUE)
                    .addComponent(self.ClearLogs, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(self.LoggingWindowArea, GroupLayout.DEFAULT_SIZE, 969, Short.MAX_VALUE)
                .addContainerGap())
        )

        LogPanelLayout.setVerticalGroup(
            LogPanelLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(LogPanelLayout.createSequentialGroup()
                      .addContainerGap()
                      .addGroup(LogPanelLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                .addComponent(self.LoggingWindowArea, GroupLayout.DEFAULT_SIZE, 269, Short.MAX_VALUE)
                                .addGroup(LogPanelLayout.createSequentialGroup()
                                          .addComponent(self.DebugEnabled, GroupLayout.PREFERRED_SIZE, 68,
                                                        GroupLayout.PREFERRED_SIZE)
                                          .addGap(18, 18, 18)
                                          .addComponent(self.ClearLogs, GroupLayout.PREFERRED_SIZE, 38,
                                                        GroupLayout.PREFERRED_SIZE)
                                          .addGap(0, 145, Short.MAX_VALUE)))
                      .addContainerGap())
        )

        self.panel = JPanel()
        layout = GroupLayout(self.panel)
        self.panel.setLayout(layout)
        layout.setHorizontalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                      .addContainerGap()
                      .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                .addGroup(layout.createSequentialGroup()
                                          .addComponent(self.VariablesToSend, GroupLayout.PREFERRED_SIZE,
                                                        GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                          .addContainerGap(35, Short.MAX_VALUE))
                                .addGroup(layout.createSequentialGroup()
                                          .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                                                    .addComponent(self.LogPanel, GroupLayout.PREFERRED_SIZE,
                                                                  GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                                    .addComponent(self.BaseVariables, GroupLayout.PREFERRED_SIZE,
                                                                  GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                                          .addGap(0, 0, Short.MAX_VALUE))))
        )
        layout.setVerticalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                      .addContainerGap()
                      .addComponent(self.BaseVariables, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE,
                                    GroupLayout.PREFERRED_SIZE)
                      .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                      .addComponent(self.VariablesToSend, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE,
                                    GroupLayout.PREFERRED_SIZE)
                      .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                      .addComponent(self.LogPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE,
                                    GroupLayout.PREFERRED_SIZE)
                      .addContainerGap(24, Short.MAX_VALUE))
        )
        self._callbacks = callbacks
        self._helpers = callbacks.getHelpers()
        callbacks.setExtensionName("Token Refresher")
        callbacks.registerHttpListener(self)
        #print "Extension registered successfully."
        callbacks.addSuiteTab(self)
        return

    def processHttpMessage(self, toolFlag, messageIsRequest, currentMessage):
        # Operate on all tools other than the proxy. Comment out if you are passing stuff through from Postman or SoapUI
        #if toolFlag != self._callbacks.TOOL_PROXY:
        if self.DebugEnabled.isSelected():
            url = str(currentMessage.getUrl())
            self.LoggingWindowPane.append("URL Requested :")
            self.LoggingWindowPane.append(url)
            self.LoggingWindowPane.append("\n")
            if self._callbacks.isInScope(currentMessage.getUrl()):
                self.LoggingWindowPane.append("URL is in scope \n")
            else:
                self.LoggingWindowPane.append("URL is not in scope \n")
        if self.IsEnabled.isSelected()and ((self._callbacks.isInScope(currentMessage.getUrl()) and self.InScopeOnly.isSelected() or not self.InScopeOnly.isSelected())) :
            if self.DebugEnabled.isSelected():
                self.LoggingWindowPane.append("Processing Message \n")
            if messageIsRequest:
                #Check to see if a replacement bearer token exists
                if BurpExtender.discoveredBearerToken != '':
                    self.processRequest(currentMessage)
            else:
                self.processResponse(currentMessage)

    def processResponse(self, currentMessage):
        if self.DebugEnabled.isSelected():
            self.LoggingWindowPane.append("Response received\n")
            if self.performingrefresh == True :
                self.LoggingWindowPane.append("Performing Token Refresh\n")
            else :
                self.LoggingWindowPane.append("Not a token refresh \n")
        response = currentMessage.getResponse()
        parsedResponse = self._helpers.analyzeResponse(response)
        respBody = self._helpers.bytesToString(response[parsedResponse.getBodyOffset():])
        if self.DebugEnabled.isSelected():
            updatelog = "Response body received : " + respBody + "\n"
            self.LoggingWindowPane.append(updatelog)
        #Search body using regex from Bearer Token Error to see if token is valid
        if self.performingrefresh == False :
            BearerErrorRegex = re.compile(self.BearerTokenValue.getText())
            token = BearerErrorRegex.search(respBody)
            if token is None:
                if self.DebugEnabled.isSelected():
                    self.LoggingWindowPane.append("Bearer token is valid\n")
            else:
                if self.DebugEnabled.isSelected():
                    self.LoggingWindowPane.append("Bearer token expired - obtaining new one\n")
                self.BearerRefresh()
                if self.DebugEnabled.isSelected():
                    if BurpExtender.discoveredBearerToken != '':
                        updatelog = "New Bearer Token Acquired : ..."+BurpExtender.discoveredBearerToken+"...\n"
                        self.LoggingWindowPane.append(updatelog)
                    else:
                        self.LoggingWindowPane.append("[!] No matching token found in response. Enable logging to view full response and check your regex\n")
        else:
            AccessTokenRegex = re.compile(self.AccessTokenValue.getText())
            token = AccessTokenRegex.search(respBody)
            if token is None:
                self.LoggingWindowPane.append("[!] Unable to extract token - no regex match\n")
            else:
                BurpExtender.discoveredBearerToken = token.group(1)
                self.CurrentBearerTokenValue.text = (BurpExtender.discoveredBearerToken)
                if self.DebugEnabled.isSelected():
                    updatelog = "Discovered response : "+str(token.group(0))+"\n" + "Extracted Token : "+BurpExtender.discoveredBearerToken+"\n"
                    self.LoggingWindowPane.append(updatelog)
        self.performingrefresh = False

    def processRequest(self, currentMessage):
        request = currentMessage.getRequest()
        requestInfo = self._helpers.analyzeRequest(request)
        headers = requestInfo.getHeaders()
        requestBody = self._helpers.bytesToString(request[requestInfo.getBodyOffset():])
        #headers is an array list
        #Convert to single string to process (sorry!)
        headerStr=""
        for x in range(len(headers)):
            headerStr = headerStr + headers[x] +"\n"
        reqBody = currentMessage.getRequest()[requestInfo.getBodyOffset():]
        reqBody = self._helpers.bytesToString(request)

        updatedheaders = headerStr

        # Update Bearer token
        if self.DebugEnabled.isSelected():
            self.LoggingWindowPane.append("Replacing Bearer Token with latest obtained\n")#,BurpExtender.discoveredBearerToken #Uncomment first hash to see bearer token

        ToSub = self.HeaderNameValue.getText()
        ToSub = ToSub.strip()
        ToSub = ToSub +" .*"
        SubWith = self.ReplacementValue.getText()
        SubWith = SubWith.strip()
        SubWith = SubWith.replace("[TOKEN]", "{0}")

        updatedheaders = re.sub(ToSub, SubWith.format(BurpExtender.discoveredBearerToken), headerStr)

        #updatedheaders = re.sub(r"Authorization: .*", "Authorization: Bearer {0}".format(BurpExtender.discoveredBearerToken), headerStr)
        if self.DebugEnabled.isSelected():
            updatelog = "New headers to be transmitted : "+updatedheaders+"\n"
            self.LoggingWindowPane.append(updatelog)
        #convert headers back into a list
        headerslist = updatedheaders.splitlines()
        updatedRequest = self._helpers.buildHttpMessage(headerslist, requestBody)
        currentMessage.setRequest(updatedRequest)


    def BearerRefresh(self):
        host = self.AuthEndPointValue.getText()
        if self.DebugEnabled.isSelected():
            updatelog = "Attempting to reach " + host + " to re-authenticate\n\n"
            self.LoggingWindowPane.append(updatelog)

        path = urlparse.urlparse(host).path
        hostname = urlparse.urlparse(host).hostname
        scheme = urlparse.urlparse(host).scheme
        port = urlparse.urlparse(host).port

        headers = []
        headers.append("POST " + path + " HTTP/1.1")
        headers.append("Host: " + hostname)
        headers.append("User-Agent: " + self.UserAgentValue.getText())
        if self.ContentTypeEnabled.isSelected():
            ContentType = self.ContentTypeValue.getText()
            headers.append("Content-Type: " + ContentType)
        else:
            headers.append("Content-Type: application/x-www-form-urlencoded")
        headers.append("Connection: close")
        data = self.AuthDataValue.getText()
        if not self.IsB64.isSelected():
            pass
        else:
            data = base64.b64decode(data)
        body = self._helpers.stringToBytes(data)
        self.messagebody = self._helpers.buildHttpMessage(headers, body)
        #newRequestMessage = self._helpers.buildHttpMessage(headers, self.messagebody)
        if self.DebugEnabled.isSelected():
            self.LoggingWindowPane.append("Message built : \n")
            self.LoggingWindowPane.append(data)
        if scheme == "https" :
            ssl = True
        else:
            ssl = False
        if port == None :
            if ssl == True :
                port = 443
            else :
                port = 80
        if self.DebugEnabled.isSelected():
            updatelog = "Hostname : " + str(hostname) + ", scheme : " + str(scheme) + ", port : " + str(port) + "\n"
            self.LoggingWindowPane.append(updatelog)
        service = self._helpers.buildHttpService(hostname, port, ssl)
        if self.DebugEnabled.isSelected():
            self.LoggingWindowPane.append("Service Built \n")
            self.LoggingWindowPane.append("Passing to thread \n")
        self.performingrefresh = True
        thread1 = thread( service, self.messagebody)
        thread1.start()


class cb():

    callbacks = None

    def __init__(self, callbacks):
        cb.callbacks = callbacks
        cb.helpers = callbacks.getHelpers()

class thread(threading.Thread):
    def __init__(self, service, message):
        threading.Thread.__init__(self)
        self.service=service
        self.message=message

    def run(self):
        try:
            #print "Making request \n"
            requested = cb.callbacks.makeHttpRequest(self.service, self.message)
        except Exception as e:
            print e
        response = cb.helpers.bytesToString(requested.getResponse())
        info = cb.helpers.analyzeResponse(response)
        body = response[info.getBodyOffset():]
        return
